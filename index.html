<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Destiny2 IDカード</title>
    <script src="https://www.line-website.com/social-plugins/js/thirdparty/loader.min.js" async="async" defer="defer"></script>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <style>
        * {
            color: rgb(240, 239, 255);
        }

        input[type="text"],
        button,
<<<<<<< HEAD
        textarea {
=======
        textarea{
>>>>>>> 27e0b6a7b5929629ceb124adab23a990f907ce84
            color: black;
        }

        html {
            background-image: linear-gradient(90deg, rgba(0, 4, 35, 1), rgba(36, 35, 85, 1) 50%, rgba(0, 4, 22, 1));
        }

        section p+* {
            margin-left: 20px;
        }

        ul {
            padding: 0;
        }

        li {
            list-style-type: none;
            list-style-position: inside;
        }

        form {
            margin-bottom: 30px;
        }

        #LINE {
            background-color: rgb(0, 166, 0);
            border-radius: 10px;
            padding: 10px 20px;
        }

        #Twitter {
            background-color: rgb(29, 155, 240);
            border-radius: 10px;
            padding: 10px 20px;
            margin-left: 30px;
        }
        .share {
            display: flex;
            gap: 20px;
        }
    </style>
    <script>
        function getParam(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        window.onload = function () {
            let name = decodeURIComponent(getParam('n'));
            if (name === '' || name === null)
                return;

            let id = decodeURIComponent(getParam('id'));
            let idn = getParam('idn');
            let platform = [getParam('p0'), getParam('p1'), getParam('p2')];
            let voice = [getParam('v0'), getParam('v1'), getParam('v2')];
            let guardian = [getParam('g0'), getParam('g1'), getParam('g2')];
            let message = decodeURIComponent(getParam('m'));

            document.getElementById('name').innerHTML = name;
            document.getElementById('bungieID').innerHTML = id + '&#035;' + idn;

            let platformListText = '';
            let voiceListText = '';
            let guardianListText = '';

            for (let i = 0; i < 3; i++) {
                if (platform[i] === 'on') {
                    let listText = i === 0 ? 'PS' : i === 1 ? 'PC' : 'XBOX';
                    platformListText += '<li>' + listText + '</li>';
                }
                if (voice[i] === 'on') {
                    let listText = i === 0 ? 'PS：' + getParam('ps') : i === 1 ? 'Discord：' + decodeURIComponent(getParam('dc')) + '&#035;' + getParam('dcn') : '聞き専';
                    voiceListText += '<li>' + listText + '</li>';
                }
                if (guardian[i] === 'on') {
                    let listText = i === 0 ? 'ハンター' : i === 1 ? 'ウォーロック' : 'タイタン';
                    guardianListText += '<li>' + listText + '</li>';
                }
            }
            document.getElementById('platform').innerHTML = platformListText;
            document.getElementById('voice').innerHTML = voiceListText;
            document.getElementById('guardian').innerHTML = guardianListText;
            document.getElementById('message').innerHTML = message;
            document.getElementById('send').innerHTML =
                '<ul class="share">' + 
                    '<li>' +
                        '<div class="line-it-button" data-lang="ja" data-type="share-a" data-env="REAL" data-url="' + encodeURI(window.location) + '" data-color="default" data-size="large" data-count="false" data-ver="3" style="display: none;"></div>' + 
                    '</li>' +
                    '<li>' + 
                        '<a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false" data-url="' + encodeURI(window.location) + '">Tweet</a>' + 
                    '</li>' +
                '</ul>';
                //'<a id="Twitter" href="https://twitter.com/share?url=' + encodeURI(window.location) + '&text=Destiny2 プロフィールカード" rel="nofollow noopener" target="_blank">Tweet</a>';
    };

    function Share() {
        let name = document.getElementsByName('n')[0].value;
        let id = document.getElementsByName('id')[0].value;
        let idn = document.getElementsByName('idn')[0].value;
        let missCount = 0;

        if (name === '')
        {
            missCount = missCount + 1;
        }
        if (id === '' || idn === ''){
            missCount = missCount + 2;
        }

        if (missCount >= 1)
        {
            switch(missCount) {
            case 1:
                alert('名前を入力してください。');
                break;
            case 2:
                alert('BungieIDを入力してください。');
                break;
            case 3:
                alert('名前とBungieIDを入力してください。');
                break;
            }
            return;
        }
        document.d2Card.submit();
    }
    </script>
</head>

<body>
    <header></header>
    <main>
        <article>
            <form name="d2Card">
                <section>
                    <p>名前</p>
                    <p id="name"><input type="text" name="n"></p>
                </section>
                <section>
                    <p>Bungie ID</p>
                    <p id="bungieID"><input type="text" name="id">&#035;<input type="text" name="idn"></p>
                </section>
                <section>
                    <p>プラットフォーム</p>
                    <ul id="platform">
                        <li><label><input type="checkbox" name="p0">PS</label></li>
                        <li><label><input type="checkbox" name="p1">PC</label></li>
                        <li><label><input type="checkbox" name="p2">XBOX</label></li>
                    </ul>
                </section>
                <section>
                    <p>ボイスチャット</p>
                    <ul id="voice">
                        <li><label><input type="checkbox" name="v0">PS：</label><input type="text" name="ps"></li>
                        <li><label><input type="checkbox" name="v1">Discord：</label><input type="text"
                                name="dc">&#035;<input type="text" name="dcn"></li>
                        <li><label><input type="checkbox" name="v2">聞き専</label></li>
                    </ul>
                </section>
                <section>
                    <p>使用ガーディアン</p>
                    <ul id="guardian">
                        <li><label><input type="checkbox" name="g0">ハンター</label></li>
                        <li><label><input type="checkbox" name="g1">ウォーロック</label></li>
                        <li><label><input type="checkbox" name="g2">タイタン</label></li>
                    </ul>
                </section>
                <section>
                    <p>一言</p>
                    <p id="message"><textarea name="m" cols="30" rows="10"></textarea></p>
                </section>
            </form>
            <p id="send"><button onclick="Share();">共有</button></p>
        </article>
    </main>
</body>

</html>
